apply plugin: "groovy"

defaultTasks "test"

repositories {
	mavenCentral()
	mavenRepo urls: "http://m2repo.spockframework.org/snapshots"
}

configurations {
	report
}

dependencies {
	groovy "org.codehaus.groovy:groovy:1.7.2"
	testCompile "org.spockframework:spock-core:0.4-groovy-1.7"
	testCompile "junit:junit:4.8.1"
	testCompile "org.hamcrest:hamcrest-all:1.1"
	report "org.apache.ant:ant-junit:1.8.1"
}

test {
	testReport = false
	afterSuite {
		if (!it.parent) {
			ant.project.addTaskDefinition("junitreport2", org.apache.tools.ant.taskdefs.optional.junit.XMLResultAggregator)
			ant.junitreport2(todir: testReportDir) {
				fileset dir: testResultsDir, includes: "TEST-*.xml"
				report todir: testReportDir, styledir: "src/build/junitreport", format: "frames"
			}
		}
	}
}